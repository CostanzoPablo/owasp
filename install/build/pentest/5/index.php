<?php
include('../header.php');

echo '<link rel="stylesheet" href="5.css">
<ul class="help-box">
	<li class="info-box"><b>Wiki:</b><br>
		<div><a target="_blank" href="https://www.owasp.org/index.php/Top_10_2013-A5-Security_Misconfiguration">Security Misconfiguration</a></div>
	</li>
	<li class="info-box"><b>Tip:</b><br>
		Is your application missing the proper security hardening across any part of the application stack? Including:

	    Is any of your software out of date? This includes the OS, Web/App Server, DBMS, applications, and all code libraries.
	    Are any unnecessary features enabled or installed (e.g., ports, services, pages, accounts, privileges)?
	    Are default accounts and their passwords still enabled and unchanged?
	    Does your error handling reveal stack traces or other overly informative error messages to users?
	    Are the security settings in your development frameworks (e.g., Struts, Spring, ASP.NET) and libraries not set to secure values?

	Without a concerted, repeatable application security configuration process, systems are at a higher risk. 

	</li>
	<li class="info-box" id="info-code" onclick="swapViewCode();"><pre>';
	$sourceCode = file_get_contents('index.php');
	$sourceCode = str_replace('b92ce242a07a91b85335d0c9927e9698', 'XXX', $sourceCode);
	echo htmlentities($sourceCode);
	echo '</pre></li>	
</ul>';

//Default acc.
//Standar /admin and standar passwords

echo '<div id="a2billing-wrapper">
<img src="a2b-logo.png">
<ul>
<li><a href="./index.php?section=home">HOME</a></li>
<li><a href="./index.php?section=help">HELP</a></li>
</ul>';


switch ($_GET["section"]) {
	case 'home':
		echo 'Home Section..';
		break;
	case 'help':
		echo 'Wiki: https://github.com/Star2Billing/a2billing/wiki';
		break;
	case 'admin':
		if (isset($_POST["name"]) AND isset($_POST["pass"]) AND $_POST["name"] == 'a2billinguser' AND $_POST["pass"] == 'a2billing'){
			echo 'FLAG UNLOCKED ! b92ce242a07a91b85335d0c9927e9698';	
		}else{
			echo 'Acces Restricted
			<form method="post" action="./index.php?section=admin">
				<input type="text" name="name" placeholder="Name"><br>
				<input type="password" name="pass" placeholder="Password" min="8"><br>
				<input type="submit" value="LOG IN">
			</form>';	
		}
		break;		
	default:
		echo 'Welcome to a custom wrapper for protect a2billing login';
		break;
}

echo '</div>';

?>