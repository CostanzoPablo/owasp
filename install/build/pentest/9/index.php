<?php
include('../header.php');

echo '<ul class="help-box">
	<li class="info-box"><b>Wiki:</b><br>
		<div><a target="_blank" href="https://www.owasp.org/index.php/Unvalidated_Redirects_and_Forwards_Cheat_Sheet">Unvalidated Redirects and Forwards</a></div>
	</li>
	<li class="info-box"><b>Tip:</b><br>
		<div>Try to redirect to google or another site...</div>
	</li>
	<li class="info-box" id="info-code" onclick="swapViewCode();"><pre>';
	$sourceCode = file_get_contents('index.php');
	$sourceCode = str_replace('67b5b9e4560f2f26c13a1dcb5e3cbb59', 'XXX', $sourceCode);
	echo htmlentities($sourceCode);
	echo '</pre></li>		
</ul>';

if (isset($_GET["logout"])){
	if (str_replace('<script>', '', $_GET["logout"]) != $_GET["logout"]){
		if (str_replace('</script>', '', $_GET["logout"]) != $_GET["logout"]){
			if (str_replace('location.href', '', $_GET["logout"]) != $_GET["logout"]){
				if (str_replace('<script>', '', $_GET["logout"]) != $_GET["logout"]){
					echo '<script>alert("FLAG Unlocked 67b5b9e4560f2f26c13a1dcb5e3cbb59");</script>';
				}
			}
		}
	}
	echo 'Goodbye '.$_GET["logout"].' !';
}else{
	echo '<br>Hi Juan. <a href="./index.php?logout=Juan">LOGOUT</a>';
}

?>