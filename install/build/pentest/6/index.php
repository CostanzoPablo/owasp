<?php
include('../header.php');

echo '<link rel="stylesheet" href="5.css">
<ul class="help-box">
	<li class="info-box"><b>Wiki:</b><br>
		<div><a target="_blank" href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">Sensitive Data Exposure</a></div>
		<div><a target="_blank" href="https://www.owasp.org/index.php/Testing_for_Weak_Encryption_(OTG-CRYPST-004)">Weak encryption</a></div>
	</li>
	<li class="info-box"><b>Tip:</b><br>
		Being very dynamic, can lead to being very malleable. Libraries are often useful. If one does not know, another capable if
	</li>
</ul>';

include('../connect.php');

foreach ($_GET as $key => $value) {
	$_GET[$key] = htmlentities(addslashes($_GET[$key]));
}
foreach ($_POST as $key => $value) {
	$_POST[$key] = htmlentities(addslashes($_POST[$key]));
}  


if (isset($_POST["name"])){
	$error = true;
	$sql=mysqli_query($con, "SELECT * FROM owasp_6_users WHERE name = '$_POST[name]'");
	while($row = mysqli_fetch_array($sql)){
		if (md5($_POST["pass"]) == $row["pass"]){
			$error = false;
			echo '<a href="./index.php?sessionid='.$row["id"].'&get=name">CONTINUE</a>';
			exit();
		}
	}

	if ($error == true){
		echo '<div>Name or Password incorrect</div>';
	}
}


if (isset($_GET["sessionid"])){
	$sql=mysqli_query($con, "SELECT * FROM owasp_6_users WHERE id = '$_GET[sessionid]'");
	while($row = mysqli_fetch_array($sql)){
		echo 'YOU ARE: '.$row[$_GET["get"]];
	}
}else{
	echo '<form method="post" action="./index.php">
		<input type="text" name="name" placeholder="Name">
		<input type="password" name="pass" placeholder="Password">
		<input type="submit" value="LOG IN">
	</form>';
}
?>
